<UserControl x:Class="Do_An.Admin_QLPH"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="900"
             Background="#f5f7fa">
    
    <UserControl.Resources>
        <!-- Style Nút bấm (Đồng bộ với GiaoDien_Admin/NVQL) -->
        <!-- Nút Xanh (Thêm/Sửa) -->
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Background" Value="#0098B0"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Margin" Value="5,0,5,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Height" Value="38"/>
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#008BA0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Nút Xóa (Màu đỏ) -->
        <Style x:Key="DeleteButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="#E63946"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#D02B3A"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header (SỬA MÀU SẮC) -->
        <Border Grid.Row="0" CornerRadius="10" Margin="0,0,0,15">
            <Border.Background>
                <!-- Đổi sang màu Xanh dương (Blue) của GiaoDien_Admin -->
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#1E88E5" Offset="0"/>
                    <GradientStop Color="#1565C0" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>

            <DockPanel LastChildFill="True" Margin="12">
                <TextBlock Text="🏫 Quản lý lớp học"
                           Foreground="White" FontSize="22" FontWeight="Bold"
                           VerticalAlignment="Center" DockPanel.Dock="Left"/>

                <!-- Ô tìm kiếm (GIỮ NGUYÊN TÊN) -->
                <Border Background="White" CornerRadius="20" Padding="6" DockPanel.Dock="Right" Width="480">
                    <DockPanel>
                        <TextBox x:Name="txtSearch"
                                 Width="220" Height="28"
                                 BorderThickness="0"
                                 FontSize="14"
                                 VerticalAlignment="Center"
                                 Background="Transparent"
                                 ToolTip="Tìm kiếm tài khoản"
                                 TextChanged="txtSearch_TextChanged"/>
                        <TextBlock Text="🔍" VerticalAlignment="Center" Margin="6,0,0,0" RenderTransformOrigin="0.468,0.594" HorizontalAlignment="Left"/>
                    </DockPanel>
                </Border>
            </DockPanel>
        </Border>

        <!-- DataGrid hiển thị (FIX LỖI THIẾU MaLop) -->
        <Border Grid.Row="1" Background="White" CornerRadius="12" BorderBrush="#ddd" BorderThickness="1">
            <DataGrid x:Name="dgLopHoc"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      IsReadOnly="True"
                      RowHeight="40"
                      AlternatingRowBackground="#f0f6ff"
                      GridLinesVisibility="Horizontal"
                      HeadersVisibility="Column"
                      FontSize="14"
                      Margin="10"
                      BorderThickness="0"
                      SelectionMode="Single"
                      SelectionUnit="FullRow">

                <DataGrid.Resources>
                    <!-- (Giữ nguyên Style DataGrid của bạn) -->
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#e3f2fd"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="FontSize" Value="14"/>
                        <Setter Property="BorderBrush" Value="#ccc"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                        <Setter Property="Padding" Value="8"/>
                    </Style>
                    <Style TargetType="DataGridRow">
                        <Setter Property="Cursor" Value="Hand"/>
                        <Setter Property="Background" Value="White"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#d6e4ff"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#90caf9"/>
                                <Setter Property="Foreground" Value="Black"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.Resources>

                <DataGrid.Columns>
                    <!-- FIX LỖI LOGIC: Thêm cột MaLop (Ẩn đi) để Code-Behind có thể đọc -->
                    <DataGridTextColumn Header="Mã Lớp" Binding="{Binding MaLop}" Width="0" Visibility="Collapsed"/>
                    
                    <DataGridTextColumn Header="Tên lớp" Binding="{Binding TenLop}" Width="2*"/>
                    <DataGridTextColumn Header="Giáo viên phụ trách" Binding="{Binding GiaoVien}" Width="2*"/>
                    <DataGridTextColumn Header="Số Học Viên" Binding="{Binding SiSo}" Width="*"/>
                    
                    <!-- BỔ SUNG: Hiển thị TrinhDo (Nếu DAL của bạn đã tải nó) -->
                    <DataGridTextColumn Header="Trình Độ" Binding="{Binding TrinhDo}" Width="1.5*"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- Nút chức năng (GIỮ NGUYÊN TÊN, SỬA STYLE) -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
            <!-- Sử dụng Style đồng bộ mới (Xanh Cyan và Đỏ) -->
            <Button x:Name="btnThem" Content="➕ Thêm" Style="{StaticResource ActionButton}" Click="btnThem_Click"/>
            <Button x:Name="btnSua" Content="✏ Sửa" Style="{StaticResource ActionButton}" Click="btnSua_Click"/>
            <Button x:Name="btnXoa" Content="🗑 Xóa" Style="{StaticResource DeleteButton}" Click="btnXoa_Click"/>
        </StackPanel>
    </Grid>
</UserControl>
